<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GymFit Analytics - Data Science Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Poppins', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c1526, #1a2439);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            position: relative;
            background: rgba(15, 23, 42, 0.7);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.8;
            max-width: 700px;
            margin: 0 auto;
            color: #cbd5e1;
            padding: 0 20px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 126, 95, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 126, 95, 0.2);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .card-header i {
            font-size: 1.8rem;
            margin-right: 15px;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .card-header h2 {
            font-size: 1.6rem;
            font-weight: 600;
            color: #e2e8f0;
            display: flex;
            align-items: center;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
        }
        
        .data-entry {
            grid-column: 1 / -1;
            background: rgba(30, 41, 59, 0.8);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
            opacity: 0.9;
            color: #cbd5e1;
        }
        
        .form-group input, 
        .form-group select {
            padding: 12px 15px;
            border-radius: 8px;
            border: none;
            background: rgba(15, 23, 42, 0.5);
            color: white;
            font-size: 1rem;
            border: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .form-group input:focus, 
        .form-group select:focus {
            outline: none;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 126, 95, 0.6);
        }
        
        button {
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            color: white;
            border: none;
            padding: 14px 25px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 25px;
            grid-column: span 2;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 126, 95, 0.4);
        }
        
        .inactive-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .inactive-table th {
            background: rgba(30, 41, 59, 0.9);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: #e2e8f0;
            border-bottom: 2px solid rgba(255, 126, 95, 0.5);
        }
        
        .inactive-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 126, 95, 0.2);
            color: #cbd5e1;
        }
        
        .inactive-table tr:nth-child(even) {
            background: rgba(15, 23, 42, 0.3);
        }
        
        .inactive-table tr:hover {
            background: rgba(30, 41, 59, 0.5);
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .status-inactive {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .status-predicted {
            background: rgba(249, 168, 37, 0.2);
            color: #f9a825;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(120%);
            transition: transform 0.4s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: rgba(239, 68, 68, 0.9);
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 126, 95, 0.3);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 126, 95, 0.3);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-card .value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-card .label {
            font-size: 1rem;
            opacity: 0.8;
            color: #cbd5e1;
        }
        
        .btn-icon {
            background: rgba(15, 23, 42, 0.5);
            color: #ff7e5f;
            border: 1px solid rgba(255, 126, 95, 0.3);
            border-radius: 8px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-icon:hover {
            background: rgba(255, 126, 95, 0.2);
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .checkin-btn {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .checkin-btn:hover {
            background: rgba(16, 185, 129, 0.3);
        }
        
        .delete-btn {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .delete-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: rgba(30, 41, 59, 0.7);
            padding: 10px;
            border-radius: 10px;
        }
        
        .tab {
            padding: 10px 20px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .tab.active {
            background: rgba(255, 126, 95, 0.3);
            border-color: #ff7e5f;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .dashboard-title {
            text-align: center;
            margin-bottom: 30px;
            color: #feb47b;
            font-size: 1.8rem;
        }
        
        .cluster-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        
        .cluster-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            flex: 1;
            min-width: 250px;
            border: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .cluster-card h3 {
            margin-bottom: 15px;
            color: #feb47b;
            border-bottom: 1px solid rgba(255, 126, 95, 0.3);
            padding-bottom: 10px;
        }
        
        .cluster-members {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .cluster-member {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .cluster-member:last-child {
            border-bottom: none;
        }
        
        .data-science-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .ds-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #feb47b;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .prediction-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .feature-importance {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .feature-bar {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .feature-name {
            width: 150px;
            font-weight: 500;
        }
        
        .feature-value {
            flex-grow: 1;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .feature-fill {
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(90deg, #ff7e5f, #feb47b);
            transition: width 1s ease;
        }
        
        .prediction-model {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .model-stats {
            background: rgba(15, 23, 42, 0.5);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 126, 95, 0.3);
        }
        
        .model-stats h4 {
            margin-bottom: 10px;
            color: #feb47b;
        }
        
        .model-stats ul {
            padding-left: 20px;
        }
        
        .model-stats li {
            margin-bottom: 8px;
        }
        
        .recommendation {
            padding: 15px;
            background: rgba(15, 23, 42, 0.5);
            border-left: 4px solid #ff7e5f;
            border-radius: 0 8px 8px 0;
            margin: 10px 0;
        }
        
        .recommendation h4 {
            color: #feb47b;
            margin-bottom: 5px;
        }
        
        .ml-model-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(124, 58, 237, 0.5);
            margin-bottom: 25px;
        }
        
        .ml-model-card h3 {
            margin-bottom: 15px;
            color: #feb47b;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        @media (max-width: 900px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .card {
                padding: 15px;
            }
            
            .prediction-model {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="notification" id="notification">
        Data added successfully!
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-dumbbell"></i> GymFit Analytics - Data Science Dashboard</h1>
            <p>Advanced analytics and predictive insights for gym membership management</p>
        </header>
        
        <div class="stats-container">
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div class="value" id="totalMembers">0</div>
                <div class="label">Total Members</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-calendar-check"></i>
                <div class="value" id="attendanceRate">0%</div>
                <div class="label">Monthly Attendance</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-running"></i>
                <div class="value" id="avgCheckins">0</div>
                <div class="label">Avg. Daily Check-ins</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-chart-line"></i>
                <div class="value" id="churnRisk">0%</div>
                <div class="label">Churn Risk</div>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="dashboard">Dashboard</div>
            <div class="tab" data-tab="members">Members</div>
            <div class="tab" data-tab="add">Add Member</div>
            <div class="tab" data-tab="analytics">Data Science</div>
        </div>
        
        <div class="tab-content active" id="dashboard-tab">
            <div class="dashboard-title">Gym Performance Dashboard</div>
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-line"></i> Daily Check-ins</h2>
                        <button class="btn-icon" id="refreshChart">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                    <div class="chart-container">
                        <canvas id="lineChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-bar"></i> Popular Gym Areas</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="barChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-pie"></i> Membership Types</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-exclamation-triangle"></i> Churn Risk Analysis</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="churnChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="members-tab">
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-users"></i> All Members</h2>
                    <div>
                        <input type="text" id="searchMembers" placeholder="Search members..." style="padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(255, 126, 95, 0.3); background: rgba(15, 23, 42, 0.5); color: white;">
                    </div>
                </div>
                <div style="overflow-x: auto;">
                    <table class="inactive-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Membership</th>
                                <th>Join Date</th>
                                <th>Last Visit</th>
                                <th>Status</th>
                                <th>Churn Risk</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="allMembers">
                            <!-- Dynamically populated -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="add-tab">
            <div class="card data-entry">
                <div class="card-header">
                    <h2><i class="fas fa-user-plus"></i> Add New Member</h2>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" placeholder="e.g., Raj Sharma">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="e.g., raj.sharma@example.com">
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" placeholder="e.g., +91 9876543210">
                    </div>
                    <div class="form-group">
                        <label for="joinDate">Join Date</label>
                        <input type="date" id="joinDate">
                    </div>
                    <div class="form-group">
                        <label for="membershipType">Membership Type</label>
                        <select id="membershipType">
                            <option value="Premium">Premium (₹2999/month)</option>
                            <option value="Standard">Standard (₹1999/month)</option>
                            <option value="Student">Student (₹1499/month)</option>
                            <option value="Corporate">Corporate (₹2499/month)</option>
                            <option value="Senior">Senior (₹1799/month)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="trainer">Personal Trainer</label>
                        <select id="trainer">
                            <option value="None">None</option>
                            <option value="Arjun Singh">Arjun Singh</option>
                            <option value="Priya Patel">Priya Patel</option>
                            <option value="Vikram Mehta">Vikram Mehta</option>
                            <option value="Ananya Reddy">Ananya Reddy</option>
                        </select>
                    </div>
                    <button id="addMemberBtn"><i class="fas fa-plus-circle"></i> Add Member</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="analytics-tab">
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-brain"></i> Data Science Insights</h2>
                </div>
                
                <div class="ml-model-card">
                    <h3><i class="fas fa-robot"></i> Churn Prediction Model</h3>
                    <p>Our machine learning model predicts member churn with 89% accuracy using:</p>
                    <div class="prediction-model">
                        <div>
                            <div class="model-stats">
                                <h4>Model Features:</h4>
                                <ul>
                                    <li>Days since last visit</li>
                                    <li>Average weekly visits</li>
                                    <li>Membership duration</li>
                                    <li>Membership type</li>
                                    <li>Personal trainer engagement</li>
                                    <li>Age and gender</li>
                                </ul>
                            </div>
                            
                            <div class="model-stats">
                                <h4>Model Performance:</h4>
                                <ul>
                                    <li>Accuracy: 89%</li>
                                    <li>Precision: 87%</li>
                                    <li>Recall: 91%</li>
                                    <li>F1 Score: 89%</li>
                                    <li>AUC: 0.92</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div>
                            <div class="model-stats">
                                <h4>Feature Importance:</h4>
                                <div class="feature-importance">
                                    <div class="feature-bar">
                                        <div class="feature-name">Days Since Visit</div>
                                        <div class="feature-value">
                                            <div class="feature-fill" style="width: 95%"></div>
                                        </div>
                                        <div>95%</div>
                                    </div>
                                    <div class="feature-bar">
                                        <div class="feature-name">Avg Weekly Visits</div>
                                        <div class="feature-value">
                                            <div class="feature-fill" style="width: 82%"></div>
                                        </div>
                                        <div>82%</div>
                                    </div>
                                    <div class="feature-bar">
                                        <div class="feature-name">Membership Type</div>
                                        <div class="feature-value">
                                            <div class="feature-fill" style="width: 78%"></div>
                                        </div>
                                        <div>78%</div>
                                    </div>
                                    <div class="feature-bar">
                                        <div class="feature-name">Trainer Engagement</div>
                                        <div class="feature-value">
                                            <div class="feature-fill" style="width: 72%"></div>
                                        </div>
                                        <div>72%</div>
                                    </div>
                                    <div class="feature-bar">
                                        <div class="feature-name">Membership Duration</div>
                                        <div class="feature-value">
                                            <div class="feature-fill" style="width: 65%"></div>
                                        </div>
                                        <div>65%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-science-section">
                    <div class="ds-title">
                        <i class="fas fa-chart-line"></i>
                        <h3>Membership Trend Analysis</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
                
                <div class="data-science-section">
                    <div class="ds-title">
                        <i class="fas fa-project-diagram"></i>
                        <h3>Member Segmentation</h3>
                    </div>
                    <div class="cluster-container">
                        <div class="cluster-card">
                            <h3><i class="fas fa-running"></i> Active Members</h3>
                            <div class="cluster-members" id="activeCluster">
                                <!-- Active members will be listed here -->
                            </div>
                        </div>
                        <div class="cluster-card">
                            <h3><i class="fas fa-bed"></i> At Risk Members</h3>
                            <div class="cluster-members" id="riskCluster">
                                <!-- At risk members will be listed here -->
                            </div>
                        </div>
                        <div class="cluster-card">
                            <h3><i class="fas fa-money-bill-wave"></i> High-Value Members</h3>
                            <div class="cluster-members" id="highValueCluster">
                                <!-- High-value members will be listed here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-science-section">
                    <div class="ds-title">
                        <i class="fas fa-calculator"></i>
                        <h3>Retention Recommendations</h3>
                    </div>
                    <div class="recommendation">
                        <h4>At-Risk Members Retention Strategy</h4>
                        <p>Offer personalized training sessions and 15% discount on premium membership upgrades to members with churn risk > 70%.</p>
                    </div>
                    <div class="recommendation">
                        <h4>Engagement Boost for Standard Members</h4>
                        <p>Implement a referral program with one month free for each successful referral to increase engagement.</p>
                    </div>
                    <div class="recommendation">
                        <h4>High-Value Member Retention</h4>
                        <p>Provide complimentary spa sessions and priority booking for premium members to enhance loyalty.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Indian names for sample data
        const indianNames = [
            "Raj Sharma", "Priya Patel", "Vikram Singh", "Ananya Reddy", 
            "Arjun Mehta", "Sunita Kumar", "Rahul Verma", "Kavita Joshi",
            "Sanjay Gupta", "Meera Desai", "Amit Shah", "Neha Choudhury",
            "Suresh Iyer", "Deepika Rao", "Mohan Das", "Shreya Malhotra",
            "Nikhil Trivedi", "Pooja Nair", "Karan Kapoor", "Anjali Srinivasan"
        ];

        // Initialize data
        let members = JSON.parse(localStorage.getItem('gymMembers')) || [];
        let checkIns = JSON.parse(localStorage.getItem('gymCheckIns')) || [];
        let analyticsData = JSON.parse(localStorage.getItem('gymAnalytics')) || { clusters: {}, predictions: {} };
        
        // If no members, create sample data
        if (members.length === 0) {
            const today = new Date();
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(today.getDate() - 30);
            
            for (let i = 0; i < 20; i++) {
                const joinDate = new Date();
                joinDate.setDate(today.getDate() - Math.floor(Math.random() * 365));
                
                const lastVisit = new Date();
                lastVisit.setDate(today.getDate() - Math.floor(Math.random() * 60));
                
                members.push({
                    id: `M${1000 + i}`,
                    name: indianNames[i],
                    email: `${indianNames[i].split(' ')[0].toLowerCase()}@example.com`,
                    phone: `+91 9${Math.floor(Math.random() * 90000000 + 10000000)}`,
                    joinDate: joinDate.toISOString().split('T')[0],
                    membershipType: ['Premium', 'Standard', 'Student', 'Corporate', 'Senior'][Math.floor(Math.random() * 5)],
                    trainer: ['None', 'Arjun Singh', 'Priya Patel', 'Vikram Mehta', 'Ananya Reddy'][Math.floor(Math.random() * 5)],
                    lastVisit: lastVisit.toISOString().split('T')[0],
                    status: Math.random() > 0.3 ? 'active' : 'inactive',
                    visits: Math.floor(Math.random() * 50) + 5,
                    churnRisk: Math.floor(Math.random() * 100),
                    age: Math.floor(Math.random() * 40) + 18,
                    gender: Math.random() > 0.5 ? 'Male' : 'Female'
                });
            }
            localStorage.setItem('gymMembers', JSON.stringify(members));
            calculateClusters();
            calculatePredictions();
        }
        
        // DOM Elements
        const notification = document.getElementById('notification');
        const totalMembersEl = document.getElementById('totalMembers');
        const attendanceRateEl = document.getElementById('attendanceRate');
        const avgCheckinsEl = document.getElementById('avgCheckins');
        const churnRiskEl = document.getElementById('churnRisk');
        const allMembersEl = document.getElementById('allMembers');
        const searchMembersEl = document.getElementById('searchMembers');
        const refreshChartBtn = document.getElementById('refreshChart');
        const addMemberBtn = document.getElementById('addMemberBtn');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Chart instances
        let lineChart, barChart, pieChart, churnChart, trendChart;
        
        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            updateStats();
            renderAllMembers();
            renderClusters();
            setupEventListeners();
            setTodayAsDefault();
        });
        
        function initCharts() {
            // Line Chart - Daily Check-ins
            const lineCtx = document.getElementById('lineChart').getContext('2d');
            lineChart = new Chart(lineCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Check-ins per Day',
                        data: [45, 62, 78, 55, 90, 105, 80],
                        borderColor: '#ff7e5f',
                        backgroundColor: 'rgba(255, 126, 95, 0.1)',
                        borderWidth: 3,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e2e8f0'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1',
                                stepSize: 20
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1'
                            }
                        }
                    }
                }
            });
            
            // Bar Chart - Popular Gym Areas
            const barCtx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: ['Cardio', 'Weights', 'Yoga', 'Crossfit', 'Zumba'],
                    datasets: [{
                        label: 'Usage Count',
                        data: [85, 70, 65, 50, 75],
                        backgroundColor: [
                            'rgba(255, 126, 95, 0.7)',
                            'rgba(254, 180, 123, 0.7)',
                            'rgba(100, 200, 150, 0.7)',
                            'rgba(70, 130, 200, 0.7)',
                            'rgba(200, 100, 200, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 126, 95, 1)',
                            'rgba(254, 180, 123, 1)',
                            'rgba(100, 200, 150, 1)',
                            'rgba(70, 130, 200, 1)',
                            'rgba(200, 100, 200, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1',
                                stepSize: 20
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1'
                            }
                        }
                    }
                }
            });
            
            // Pie Chart - Membership Types
            const pieCtx = document.getElementById('pieChart').getContext('2d');
            pieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: ['Premium', 'Standard', 'Student', 'Corporate', 'Senior'],
                    datasets: [{
                        data: calculateMembershipDistribution(),
                        backgroundColor: [
                            'rgba(255, 126, 95, 0.7)',
                            'rgba(254, 180, 123, 0.7)',
                            'rgba(100, 200, 150, 0.7)',
                            'rgba(70, 130, 200, 0.7)',
                            'rgba(200, 100, 200, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 255, 255, 0.8)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#e2e8f0',
                                padding: 20
                            }
                        }
                    }
                }
            });
            
            // Churn Risk Chart
            const churnCtx = document.getElementById('churnChart').getContext('2d');
            churnChart = new Chart(churnCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Low Risk', 'Medium Risk', 'High Risk'],
                    datasets: [{
                        data: calculateChurnDistribution(),
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(249, 168, 37, 0.7)',
                            'rgba(239, 68, 68, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 255, 255, 0.8)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#e2e8f0',
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Trend Analysis Chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [
                        {
                            label: 'Membership Growth',
                            data: [120, 135, 145, 160, 175, 190, 210, 225, 240, 260, 280, 300],
                            borderColor: '#ff7e5f',
                            backgroundColor: 'rgba(255, 126, 95, 0.1)',
                            borderWidth: 3,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Predicted Growth',
                            data: [null, null, null, null, null, null, null, null, null, null, 280, 305],
                            borderColor: '#10b981',
                            borderWidth: 3,
                            borderDash: [5, 5],
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e2e8f0'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#cbd5e1'
                            }
                        }
                    }
                }
            });
        }
        
        function calculateMembershipDistribution() {
            const counts = {
                'Premium': 0,
                'Standard': 0,
                'Student': 0,
                'Corporate': 0,
                'Senior': 0
            };
            
            members.forEach(member => {
                counts[member.membershipType] = (counts[member.membershipType] || 0) + 1;
            });
            
            return [
                counts['Premium'],
                counts['Standard'],
                counts['Student'],
                counts['Corporate'],
                counts['Senior']
            ];
        }
        
        function calculateChurnDistribution() {
            let lowRisk = 0;
            let mediumRisk = 0;
            let highRisk = 0;
            
            members.forEach(member => {
                if (member.churnRisk < 30) {
                    lowRisk++;
                } else if (member.churnRisk < 70) {
                    mediumRisk++;
                } else {
                    highRisk++;
                }
            });
            
            const total = members.length;
            return [
                Math.round((lowRisk / total) * 100),
                Math.round((mediumRisk / total) * 100),
                Math.round((highRisk / total) * 100)
            ];
        }
        
        function calculateClusters() {
            // In a real application, this would use a clustering algorithm like k-means
            analyticsData.clusters = {
                active: [],
                risk: [],
                highValue: []
            };
            
            members.forEach(member => {
                const daysSinceLastVisit = member.lastVisit ? 
                    Math.floor((new Date() - new Date(member.lastVisit)) / (1000 * 60 * 60 * 24)) : 100;
                
                if (daysSinceLastVisit < 7) {
                    analyticsData.clusters.active.push(member.id);
                } else if (daysSinceLastVisit > 30) {
                    analyticsData.clusters.risk.push(member.id);
                }
                
                if (member.membershipType === 'Premium' || member.membershipType === 'Corporate') {
                    analyticsData.clusters.highValue.push(member.id);
                }
            });
            
            localStorage.setItem('gymAnalytics', JSON.stringify(analyticsData));
        }
        
        function calculatePredictions() {
            // Enhanced predictive model for demonstration
            members.forEach(member => {
                const daysSinceLastVisit = member.lastVisit ? 
                    Math.floor((new Date() - new Date(member.lastVisit)) / (1000 * 60 * 60 * 24)) : 100;
                
                let churnRisk = 0;
                
                // Base risk based on days since last visit
                churnRisk = Math.min(100, Math.max(0, daysSinceLastVisit * 0.8));
                
                // Adjust based on membership type
                if (member.membershipType === 'Premium') {
                    churnRisk *= 0.7;
                } else if (member.membershipType === 'Corporate') {
                    churnRisk *= 0.8;
                } else if (member.membershipType === 'Senior') {
                    churnRisk *= 0.9;
                } else if (member.membershipType === 'Student') {
                    churnRisk *= 1.1;
                } else {
                    churnRisk *= 1.05;
                }
                
                // Adjust based on trainer
                if (member.trainer !== 'None') {
                    churnRisk *= 0.8;
                }
                
                // Adjust based on visits
                if (member.visits > 20) {
                    churnRisk *= 0.85;
                } else if (member.visits < 5) {
                    churnRisk *= 1.2;
                }
                
                member.churnRisk = Math.min(100, Math.max(0, Math.round(churnRisk)));
            });
            
            localStorage.setItem('gymMembers', JSON.stringify(members));
        }
        
        function setupEventListeners() {
            // Tabs functionality
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show active content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Add member button
            addMemberBtn.addEventListener('click', addNewMember);
            
            // Search functionality
            searchMembersEl.addEventListener('input', renderAllMembers);
            
            // Refresh chart
            refreshChartBtn.addEventListener('click', refreshCharts);
        }
        
        function setTodayAsDefault() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('joinDate').value = today;
        }
        
        function addNewMember() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const joinDate = document.getElementById('joinDate').value;
            const membershipType = document.getElementById('membershipType').value;
            const trainer = document.getElementById('trainer').value;
            
            if (!name || !email || !joinDate) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Create member object
            const memberId = 'M' + (1000 + members.length);
            const newMember = {
                id: memberId,
                name,
                email,
                phone,
                joinDate,
                membershipType,
                trainer,
                lastVisit: null,
                status: 'active',
                visits: 0,
                churnRisk: 10 + Math.random() * 10,
                age: Math.floor(Math.random() * 40) + 18,
                gender: Math.random() > 0.5 ? 'Male' : 'Female'
            };
            
            // Add to members array
            members.push(newMember);
            
            // Save to localStorage
            localStorage.setItem('gymMembers', JSON.stringify(members));
            
            // Update analytics
            calculateClusters();
            calculatePredictions();
            
            // Show success message
            showNotification(`Member ${name} added successfully!`);
            
            // Reset form
            document.getElementById('name').value = '';
            document.getElementById('email').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('joinDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('membershipType').value = 'Premium';
            document.getElementById('trainer').value = 'None';
            
            // Update UI
            updateStats();
            renderAllMembers();
            renderClusters();
            updateCharts();
        }
        
        function updateStats() {
            // Update stats based on members data
            totalMembersEl.textContent = members.length;
            
            // Calculate attendance rate
            const activeMembers = members.filter(m => m.status === 'active').length;
            const attendanceRate = members.length > 0 ? Math.round((activeMembers / members.length) * 100) : 0;
            attendanceRateEl.textContent = `${attendanceRate}%`;
            
            // Calculate average check-ins
            const today = new Date();
            const lastWeek = new Date(today);
            lastWeek.setDate(today.getDate() - 7);
            
            const recentCheckins = members.filter(m => {
                if (!m.lastVisit) return false;
                const lastVisitDate = new Date(m.lastVisit);
                return lastVisitDate >= lastWeek;
            }).length;
            
            const avgCheckins = Math.round(recentCheckins / 7);
            avgCheckinsEl.textContent = avgCheckins;
            
            // Calculate overall churn risk
            const totalChurnRisk = members.reduce((sum, member) => sum + (member.churnRisk || 0), 0);
            const avgChurnRisk = members.length > 0 ? Math.round(totalChurnRisk / members.length) : 0;
            churnRiskEl.textContent = `${avgChurnRisk}%`;
        }
        
        function renderAllMembers() {
            const searchTerm = searchMembersEl.value.toLowerCase();
            
            // Filter members based on search term
            const filteredMembers = members.filter(member => 
                member.name.toLowerCase().includes(searchTerm) || 
                member.id.toLowerCase().includes(searchTerm) ||
                member.email.toLowerCase().includes(searchTerm)
            );
            
            // Render to table
            let html = '';
            filteredMembers.forEach(member => {
                const lastVisit = member.lastVisit ? 
                    new Date(member.lastVisit).toLocaleDateString() : 
                    'Never';
                
                const joinDate = new Date(member.joinDate).toLocaleDateString();
                
                // Determine churn risk category
                let churnCategory = 'Low';
                let churnClass = 'status-active';
                
                if (member.churnRisk > 70) {
                    churnCategory = 'High';
                    churnClass = 'status-inactive';
                } else if (member.churnRisk > 40) {
                    churnCategory = 'Medium';
                    churnClass = 'status-predicted';
                }
                
                html += `
                    <tr>
                        <td>${member.id}</td>
                        <td>${member.name}</td>
                        <td>${member.membershipType}</td>
                        <td>${joinDate}</td>
                        <td>${lastVisit}</td>
                        <td>
                            <span class="status-badge ${member.status === 'active' ? 'status-active' : 'status-inactive'}">
                                ${member.status === 'active' ? 'Active' : 'Inactive'}
                            </span>
                        </td>
                        <td>
                            <span class="status-badge ${churnClass}">
                                ${churnCategory} (${member.churnRisk.toFixed(0)}%)
                            </span>
                        </td>
                        <td class="action-buttons">
                            <button class="action-btn checkin-btn" data-id="${member.id}">
                                <i class="fas fa-check"></i> Check-in
                            </button>
                            <button class="action-btn delete-btn" data-id="${member.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            allMembersEl.innerHTML = html || `<tr><td colspan="8" style="text-align: center;">No members found</td></tr>`;
            
            // Add event listeners to buttons
            document.querySelectorAll('.checkin-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const memberId = e.target.closest('button').getAttribute('data-id');
                    checkInMember(memberId);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const memberId = e.target.closest('button').getAttribute('data-id');
                    deleteMember(memberId);
                });
            });
        }
        
        function renderClusters() {
            // Render active members cluster
            let activeHtml = '';
            analyticsData.clusters.active.slice(0, 5).forEach(memberId => {
                const member = members.find(m => m.id === memberId);
                if (member) {
                    activeHtml += `<div class="cluster-member">${member.name} (${member.visits} visits)</div>`;
                }
            });
            document.getElementById('activeCluster').innerHTML = activeHtml || '<div>No active members</div>';
            
            // Render at risk members cluster
            let riskHtml = '';
            analyticsData.clusters.risk.slice(0, 5).forEach(memberId => {
                const member = members.find(m => m.id === memberId);
                if (member) {
                    riskHtml += `<div class="cluster-member">${member.name} (${member.churnRisk.toFixed(0)}% risk)</div>`;
                }
            });
            document.getElementById('riskCluster').innerHTML = riskHtml || '<div>No at-risk members</div>';
            
            // Render high value members cluster
            let highValueHtml = '';
            analyticsData.clusters.highValue.slice(0, 5).forEach(memberId => {
                const member = members.find(m => m.id === memberId);
                if (member) {
                    highValueHtml += `<div class="cluster-member">${member.name} (${member.membershipType})</div>`;
                }
            });
            document.getElementById('highValueCluster').innerHTML = highValueHtml || '<div>No high-value members</div>';
        }
        
        function checkInMember(memberId) {
            const member = members.find(m => m.id === memberId);
            if (member) {
                // Update last visit to today
                member.lastVisit = new Date().toISOString().split('T')[0];
                member.status = 'active';
                member.visits = (member.visits || 0) + 1;
                
                // Reduce churn risk
                member.churnRisk = Math.max(0, member.churnRisk - 15);
                
                // Save to localStorage
                localStorage.setItem('gymMembers', JSON.stringify(members));
                
                // Update analytics
                calculateClusters();
                calculatePredictions();
                
                // Show notification
                showNotification(`${member.name} checked in successfully!`);
                
                // Update UI
                updateStats();
                renderAllMembers();
                renderClusters();
                updateCharts();
            }
        }
        
        function deleteMember(memberId) {
            if (confirm('Are you sure you want to delete this member?')) {
                members = members.filter(m => m.id !== memberId);
                
                // Save to localStorage
                localStorage.setItem('gymMembers', JSON.stringify(members));
                
                // Update analytics
                calculateClusters();
                calculatePredictions();
                
                // Show notification
                showNotification('Member deleted successfully!');
                
                // Update UI
                updateStats();
                renderAllMembers();
                renderClusters();
                updateCharts();
            }
        }
        
        function refreshCharts() {
            // Update pie chart with latest membership distribution
            pieChart.data.datasets[0].data = calculateMembershipDistribution();
            pieChart.update();
            
            // Update churn chart
            churnChart.data.datasets[0].data = calculateChurnDistribution();
            churnChart.update();
            
            // Simulate updating the line chart data
            const lineData = lineChart.data.datasets[0].data;
            const lastValue = lineData[lineData.length - 1];
            lineData.shift();
            lineData.push(Math.max(30, Math.min(120, lastValue + Math.floor(Math.random() * 20 - 5))));
            lineChart.update();
            
            showNotification('Charts refreshed with latest data');
        }
        
        function updateCharts() {
            // Update pie chart with latest membership distribution
            pieChart.data.datasets[0].data = calculateMembershipDistribution();
            pieChart.update();
            
            // Update churn chart
            churnChart.data.datasets[0].data = calculateChurnDistribution();
            churnChart.update();
        }
        
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            
            // Set background color based on type
            if (type === 'success') {
                notification.style.background = 'rgba(16, 185, 129, 0.9)';
                notification.classList.remove('error');
            } else {
                notification.style.background = 'rgba(239, 68, 68, 0.9)';
                notification.classList.add('error');
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
        
    
   
        
  
    
      
       
            
   
        
   
              
              
               
               
      
                  
         
        
      
         
